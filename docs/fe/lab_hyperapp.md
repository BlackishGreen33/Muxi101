# Lab: 使用 Hyperapp 编写 TodoList


## GUI 编程：一个由组件构成的世界


前端方向所编写的主要是运行在 Web 浏览器中的 GUI（图形化用户界面）应用程序。包括简单的新闻页面，到复杂的在线 [Office 等应用](https://shimo.im/)，都可以在浏览器内实现。

> 这是比较狭义的前端。目前广义的大前端工程师也会做一些服务端和客户端的研发。但对前端来说，编写用户界面始终是核心的话题。

之前大家也写过页面。页面是由很多个相互嵌套的标签构成的。如果我们把页面内容按页面的结构分组，就可以分出很多的组件（Component）。

写组件，主要是通过 JavaScript 实现的。原因如下：

+ 像之前写页面那样，直接写 HTML 和 CSS，就无法实现组件化的，因为组件化的前提是模块化。**只有 JS 有模块化的能力**。
+ 组件除了结构（HTML）和样式（CSS）之外，最主要的是**交互逻辑**，也就是这个组件会响应用户的操作，对页面进行动态的修改。以及和服务端交互，发送网络请求获取数据，展示在页面中等等。这部分逻辑是通过浏览器的 API 实现的，主要是 DOM 相关。比如我们可以使用 DOM API 去动态的增加元素，修改元素。我们可以用 `addEventListener` 来添加事件，响应用户交互。用 fetch API 发送网络请求。这些交互逻辑显然只能在 JS 中实现。

所以对于前端中的组件化，一个组件就是一个 JS 模块，这个模块控制了页面某块区域的**结构，样式，和用户交互逻辑**。

> 如果对组件化还有疑问，可以看[这篇专题](/101/fe/component.html)。里面用一个页面作为例子，讲了具体的组件拆分方式。

GUI 编程其实就是一个搭积木的过程，拆分组件，若干个组件拼成一个页面，所有的页面加起来，就构成了一个应用程序（Application）。

看到这里，你可能对如何使用 JS 写一个应用，如何写一个组件，还是没有概念。接下来我们就会借助一个第三方库：Hyperapp，来实现 GUI 编程。



## Hyperapp 简介：`UI = f(state)`


[Hyperapp](https://github.com/jorgebucaran/hyperapp) 的 Github 主页


## 告别 h，使用 JSX


## TodoList





## 拓展：React 与 Hyperapp



## 拓展：No Magic!! Hyperapp 源码解析


你需要记得一件事，**No Magic**。这是一个很朴素的理念，你必须搞懂你所使用的工具（在这个场景下，是第三方库），并且有自己实现这个工具的能力，你才可以真正驾驭这个工具。

第三方 JS 库，其实也是用 JS 写的，和你自己写的 JS 代码并不存在什么区别。这个库也不是一个黑盒子。只要你懂 JS，它对你来说就应该是透明的。当然理解这个库的原理会需要你理解一些 Web GUI 编程的设计理念，花费一些时间专研，但绝对不是一件难事。

我们在教大家使用 React 进行前端开发之前，首先引入 Hyperapp，就是因为这个库足够简单，但又包含了编写一个组件化 Web APP 所需要的的必要元素。用过 Hyperapp 之后，你可以看懂它的源代码，从而理解这种 UI 组件基础库的本质。这对于未来的前端开发之路有很大的帮助，因为你知道，这些东西都是普通的，没有魔法。


> 按 No Magic 的理念，我们是否需要知道浏览器的原理呢？其实这个理念是相对而言的。计算机系统由许多不同软硬件技术共同构成，这些技术是分层的。比如操作系统层面，编程语言层面，
对 JS 这项基础技术来说，如果你掌握了 JS 本身，那用 JS 写出来的东西，都不应该是什么秘密（这些都属于 JS 相关的范畴）。探究 JS 本身是怎么实现的，其实已经进入了另一个领域（编程语言实现）了，所以就算你不了解 JS 是怎么被编译运行的，你也能写出好的 Web App。但如果你对浏览器和 JS 引擎的原理有了解，肯定会对你有很大的帮助。总的来说，作为一个前端开发，你不需要看懂浏览器和 JS 引擎的 C++ 源码，但你至少需要了解浏览器和 JS 引擎的一些关键原理。相比用 Hyperapp 写东西 + 读懂 Hyperapp 源码这种组合，这个要求要低很多。计算机的世界有一个很重要的理念，就是分层。不同层之间通过某种协议和接口进行联系。我们要有分辨一项技术属于哪一层的能力。对于同一层里面的技术，你应该有看懂源码的能力。

>![layered](./img/component/layerer.jpg)
> *计算机系统的分层架构*